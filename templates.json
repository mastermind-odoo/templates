{
  "version": "2",
  "templates": [
    {
      "type": "stack",
      "title": "Odoo Instance",
      "description": "Crea una instancia de Odoo 18 con dominio y base de datos inicial",
      "note": "Cada despliegue crea un contenedor Odoo + DB inicial en Postgres con SSL autom√°tico.",
      "categories": ["Odoo", "ERP"],
      "platform": "linux",
      "logo": "https://www.odoo.com/web/image/website/1/favicon",
      "env": [
        {
          "name": "INSTANCE",
          "label": "Nombre interno de la instancia (ej: cliente1)",
          "default": "cliente1"
        },
        {
          "name": "DOMAIN",
          "label": "Dominio/subdominio (ej: cliente1.midominio.com)",
          "default": "cliente1.midominio.com"
        },
        {
          "name": "LETSENCRYPT_EMAIL",
          "label": "Correo para Let's Encrypt",
          "default": "admin@midominio.com"
        }
      ],
      "stack": {
        "version": "3.8",
        "services": {
          "{{INSTANCE}}": {
            "image": "odoo:18.0",
            "container_name": "{{INSTANCE}}-odoo",
            "restart": "always",
            "environment": [
              "VIRTUAL_HOST={{DOMAIN}}",
              "LETSENCRYPT_HOST={{DOMAIN}}",
              "LETSENCRYPT_EMAIL={{LETSENCRYPT_EMAIL}}",
              "VIRTUAL_PORT=8069"
            ],
            "volumes": [
              "{{INSTANCE}}-data:/var/lib/odoo",
              "./instancias/{{INSTANCE}}/addons:/mnt/extra-addons",
              "./instancias/{{INSTANCE}}/addons_extra:/mnt/extra-addons-extra",
              "/odoo-docker/scripts/odoo.conf.base:/etc/odoo/odoo.conf",
              "/odoo-docker/scripts/init_odoo.sh:/etc/odoo/init_odoo.sh"
            ],
            "networks": ["proxy-tier"],
            "command": ["/bin/bash", "/etc/odoo/init_odoo.sh"]
          }
        },
        "volumes": {
          "{{INSTANCE}}-data": {}
        },
        "networks": {
          "proxy-tier": { "external": true }
        }
      }
    }
  ]
}
