{
    "version": "2",
    "templates": [
        {
            "type": "stack",
            "title": "Odoo Instance",
            "description": "Crea una instancia de Odoo 18 con dominio y DB inicial",
            "env": [
                {
                    "name": "INSTANCE",
                    "label": "Nombre interno",
                    "default": "cliente1"
                },
                {
                    "name": "DOMAIN",
                    "label": "Dominio/subdominio",
                    "default": "cliente1.midominio.com"
                },
                {
                    "name": "LETSENCRYPT_EMAIL",
                    "label": "Correo para SSL",
                    "default": "admin@midominio.com"
                }
            ],
            "stack": {
                "version": "3.8",
                "services": {
                    "{{INSTANCE}}": {
                        "image": "odoo:18.0",
                        "container_name": "{{INSTANCE}}-odoo",
                        "restart": "always",
                        "environment": [
                            "VIRTUAL_HOST={{DOMAIN}}",
                            "LETSENCRYPT_HOST={{DOMAIN}}",
                            "LETSENCRYPT_EMAIL={{LETSENCRYPT_EMAIL}}",
                            "VIRTUAL_PORT=8069"
                        ],
                        "volumes": [
                            "{{INSTANCE}}-data:/var/lib/odoo",
                            "./instancias/{{INSTANCE}}/addons:/mnt/extra-addons",
                            "/odoo-docker/scripts/odoo.conf.base:/etc/odoo/odoo.conf",
                            "/odoo-docker/scripts/init_odoo.sh:/etc/odoo/init_odoo.sh"
                        ],
                        "networks": [
                            "proxy-tier"
                        ],
                        "command": [
                            "/bin/bash",
                            "/etc/odoo/init_odoo.sh"
                        ]
                    }
                },
                "volumes": {
                    "{{INSTANCE}}-data": {}
                },
                "networks": {
                    "proxy-tier": {
                        "external": true
                    }
                }
            }
        }
    ]
}
